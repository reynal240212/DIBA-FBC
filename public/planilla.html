<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Planilla DIBA FBC - PDF</title>
  <!-- Carga jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <!-- Carga el complemento autoTable para tablas -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.5.25/dist/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
  <h1>Generar PDF - Planilla DIBA FBC</h1>
  <button id="generatePDF">Descargar PDF</button>

  <script>
    document.getElementById('generatePDF').addEventListener('click', async () => {
      const { jsPDF } = window.jspdf;

      // 1. Configuración: modo "portrait" para repartir en varias páginas si no cabe
      const doc = new jsPDF({
        orientation: 'portrait',
        unit: 'pt',
        format: 'letter' // 612 x 792 pt aprox.
      });

      // 2. Inserta el LOGO (usa la ruta o URL de tu imagen)
      // Para un mejor resultado, usa un enlace HTTPS o base64.
      const logoUrl = "https://i.postimg.cc/x8W7vwJJ/ESCUDO.png"; // Ejemplo
      // Descargamos la imagen como base64 para que jsPDF pueda insertarla
      const imgData = await getBase64ImageFromUrl(logoUrl);
      // Agregamos la imagen en x=40, y=20, con ancho=60, alto=60 (ajusta según requieras)
      doc.addImage(imgData, 'PNG', 40, 20, 60, 60);

      // 3. Encabezados
      doc.setFontSize(14);
      doc.text("DIBA FBC", 120, 40);
      doc.setFontSize(10);
      doc.text("DEPORTIVO INTERNACIONAL DE BARRANQUILLA ATLANTICO", 120, 55);
      doc.text("RESOLUCIÓN 0122 /2018- 10/SEPT/2018", 120, 70);
      doc.text("Planilla de control", 120, 85);

      // 4. Define las columnas y filas de la tabla
      const columns = ["#", "Nombre", "pagos", "asistencia", "disciplina"];
      const rows = [
        ["1",  "Abraham",        "", "", ""],
        ["2",  "Adrian",         "", "", ""],
        ["3",  "Angel",          "", "", ""],
        ["4",  "Brayan",         "", "", ""],
        ["5",  "Breiner Davalos","", "", ""],
        ["6",  "Breiner Vargas", "", "", ""],
        ["7",  "Carlos",         "", "", ""],
        ["8",  "Cristopher",     "", "", ""],
        ["9",  "Daniel",         "", "", ""],
        ["10", "Dany",           "", "", ""],
        ["11","Dilan",           "", "", ""],
        ["12","Dinkol",          "", "", ""],
        ["13","Eliuth",          "", "", ""],
        ["14","Esteban",         "", "", ""],
        ["15","Gomez Angel",     "", "", ""],
        ["16","ISAAC",           "", "", ""],
        ["17","Jarveis",         "", "", ""],
        ["18","Jesus",           "", "", ""],
        ["19","Jhoyfran",        "", "", ""],
        ["20","Joseth",          "", "", ""],
        ["21","Josue",           "", "", ""],
        ["22","Juan",            "", "", ""],
        ["23","Juan Andrés",     "", "", ""],
        ["24","Juan José",       "", "", ""],
        ["25","Karles",          "", "", ""],
        ["26","Kenner",          "", "", ""],
        ["27","Keyner",          "", "", ""],
        ["28","LEONARDO",        "", "", ""],
        ["29","Leonardo",        "", "", ""],
        ["30","Luis Moreno",     "", "", ""],
        ["31","Mario",           "", "", ""],
        ["32","Mateo",           "", "", ""],
        ["33","Miguel",          "", "", ""],
        ["34","Nayareth",        "", "", ""],
        ["35","Nelson",          "", "", ""],
        ["36","Oscar Lopez",     "", "", ""],
        ["37","Oscar Sanchez",   "", "", ""],
        ["38","Rey David",       "", "", ""],
        ["39","Santiago",        "", "", ""],
        ["40","Santy",           "", "", ""],
        ["41","Santy T",         "", "", ""],
        ["42","Yojainer",        "", "", ""],
        ["43","Zaid",            "", "", ""]
      ];

      // 5. Genera la tabla usando autoTable
      doc.autoTable({
        head: [columns],
        body: rows,
        startY: 100,
        margin: { left: 40, right: 40 },
        styles: {
          fontSize: 10,        // Ajusta tamaño de fuente
          cellPadding: 4,      // Espacio interno de celdas
          halign: 'center',
          valign: 'middle'
        },
        headStyles: {
          fillColor: [0, 27, 114], // Azul oscuro
          textColor: 255
        },
        alternateRowStyles: {
          fillColor: [240, 240, 240] // Gris claro
        },
        tableWidth: 'auto',
        pageBreak: 'auto' // Se partirá en páginas adicionales si no cabe
      });

      // 6. Descargar el PDF
      doc.save("PlanillaDIBA.pdf");
    });

    // Función auxiliar para convertir imagen externa a Base64
    async function getBase64ImageFromUrl(imageUrl) {
      const res = await fetch(imageUrl);
      const blob = await res.blob();
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onloadend = () => {
          resolve(reader.result);
        };
        reader.readAsDataURL(blob);
      });
    }
  </script>
</body>
</html>
